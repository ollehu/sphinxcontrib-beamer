% NIRA Simple Theme
\ProvidesPackage{nira}

% Tikz setup.
\usepackage{tikz}
\usetikzlibrary{arrows,shapes,trees,positioning,fadings}
\global\let\tikz@ensure@dollar@catcode=\relax

% Package setup.
\usepackage{amsmath}
\usepackage{lmodern}
\usepackage[scale=2]{ccicons}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{tabu}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{xcolor}
\usepackage{etoolbox}

% Setup macros and water mark.
\input xkeyval
\def\@hos{}
\def\@vos{}
\define@key{setwatermark}{hoffset}[\def\@hos{.}]{\def\@hos{\hspace*{#1}}}
\define@key{setwatermark}{voffset}[\def\@vos{.}]{\def\@vos{\vspace*{#1}}}
\def\setwatermark{\@ifnextchar[\@setwatermark{\@setwatermark[]}}
\def\@setwatermark[#1]#2{%
    \setkeys{setwatermark}{#1}%
    \def\@watermark{#2}%
}

\newcommand*{\setwatermarkcolor}{%
    \setwatermark{\includegraphics[height=1.5cm]{nira_logo}}%
}

\newcommand*{\setwatermarkbw}{%
    \setwatermark{\includegraphics[height=2cm]{nira_logo_bw}}%
}

% Hide covered.
\setbeamercovered{invisible}

% Set up aliases for 'confidential' and 'classified'.
\newcommand*{\augmentframetitle}[1]{%
    \expandafter\frametitle\expandafter%
    {\beamer@frametitle #1}%
}

\newcommand*{\confidential}{\augmentframetitle{%
\hspace{0pt plus 1filll} \textcolor{red}{\normalfont CONFIDENTIAL}}}

\newcommand*{\classified}{\augmentframetitle{%
\hspace{0pt plus 1filll} \textcolor{red}{\normalfont CLASSIFIED}}}

\mode<presentation>

    \definecolor{titlecolor}{HTML}{515151} % title
    \definecolor{normal}{HTML}{393939}  % gray
    \definecolor{bgcolor}{HTML}{e6e6e6}  % bg

    \setbeamercolor{normal text}{bg=white,fg=normal}
    \setbeamercolor*{block title}{bg=bgcolor,fg=titlecolor}
    \setbeamercolor*{block body}{bg=bgcolor,fg=normal}
    \setbeamercolor{alerted text}{fg=black}

    \usetheme{default}
    \usecolortheme[named=titlecolor]{structure}
    \usefonttheme{structurebold}

    \setbeamercovered{transparent}
    \setbeamertemplate{footline}[frame number]
    \setbeamertemplate{navigation symbols}{}
    \setbeamertemplate{blocks}[rounded][shadow=true]

    % Margins.
    \setbeamersize{text margin left=0.4cm,text margin right=0.4cm}

    % Watermark.
    \setbeamertemplate{background}{
    \parbox[c][\paperheight]{\paperwidth}{%
        \ifbeamer@plainframe
        \else
            \ifnum\c@framenumber=1%
                \setwatermarkcolor
                \vfill \centering
                \begin{tikzpicture}
                    \node[opacity=.2, minimum width=4cm]
                    {
                        \@watermark
                    };
                \end{tikzpicture}
            \else
                \setwatermarkbw
                \vfill \hfill
                \begin{tikzpicture}
                    \node[opacity=.2, minimum width=4cm]
                    {
                        \@watermark
                    };
                \end{tikzpicture}
            \fi
        \fi
      \@hos

      \@vos
    }
}

\mode
<all>
